<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AuraText Scanner Pro</title>
<link href="fonts.googleapis.com" rel="stylesheet">
<style>
    /* Professional 'Aura' Theme Styles */
    :root {
        --bg-dark: #0a0a1a;
        --accent-cyan: #00ffe0;
        --accent-blue: #00b3ff;
        --card-bg: #1a1a3a;
        --text-color: #e0e0e0;
    }

    body {
        margin: 0;
        padding: 40px 20px;
        font-family: 'Roboto Mono', monospace, Arial;
        background: var(--bg-dark);
        color: var(--text-color);
        text-align: center;
        line-height: 1.6;
    }

    .container {
        max-width: 800px;
        margin: 0 auto;
    }

    h1 {
        font-size: 2.5rem;
        background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 25px;
        letter-spacing: 2px;
        text-shadow: 0 0 10px rgba(0, 255, 224, 0.5);
    }

    .controls {
        margin-bottom: 25px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
    }

    button, .custom-file-btn {
        padding: 12px 25px;
        margin: 8px;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
        color: var(--bg-dark);
        cursor: pointer;
        transition: transform .3s ease, box-shadow .3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    button:hover, .custom-file-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 255, 224, 0.4);
    }

    button:disabled {
        background: #555;
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
    }

    #fileInput {
        display: none;
    }

    #videoContainer {
        position: relative;
        display: inline-block;
        margin-top: 15px;
        background: var(--card-bg);
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0, 179, 255, 0.3);
        padding: 10px;
    }

    #video {
        width: 100%;
        max-width: 400px;
        border-radius: 10px;
        display: block;
    }

    #scannerBox {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 70%;
        height: 35%;
        border: 2px dashed var(--accent-cyan);
        border-radius: 10px;
        pointer-events: none;
        box-shadow: 0 0 15px rgba(0, 255, 224, 0.7);
    }

    #contentBox {
        margin-top: 30px;
        padding: 25px;
        min-height: 150px;
        border: 1px solid var(--accent-blue);
        border-radius: 10px;
        background: var(--card-bg);
        box-shadow: inset 0 0 15px rgba(0, 179, 255, 0.2);
        font-size: 1rem;
        word-wrap: break-word;
        white-space: pre-wrap;
        text-align: left;
        overflow-y: auto;
        max-height: 300px;
    }

    #statusDiv {
        margin-top: 15px;
        font-size: 0.9rem;
        color: var(--accent-cyan);
        text-shadow: 0 0 5px rgba(0, 255, 224, 0.5);
    }

    /* âœ” Bottom-Right CLEAR Button (Added) */
   #clearBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 12px 25px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    background: linear-gradient(135deg, #ff4d4d, #ff0000); /* ðŸ”´ Red gradient */
    color: #ffffff;
    cursor: pointer;
    transition: transform .3s ease, box-shadow .3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    z-index: 9999;
}

#clearBtn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 0, 0, 0.45); /* ðŸ”¥ Red glow */
}


</style>
</head>
<body>

<div class="container">
    <h1>Aura Scanner</h1>

    <div class="controls">
        <label for="fileInput" class="custom-file-btn">ðŸ“‚ Upload Text File</label>
        <input type="file" id="fileInput" accept=".txt">
        <button onclick="startScanner()">ðŸ“¸ Start Live Scan</button>
        <button onclick="stopScanner()">ðŸ›‘ Stop Scanner</button>
    </div>

    <div id="videoContainer">
        <video id="video" autoplay playsinline></video>
        <div id="scannerBox"></div>
    </div>

    <div id="previewBox" style="display: none;"></div> 

    <div id="contentBox">Scanned text will appear hereâ€¦</div>
    <div id="statusDiv">Status: Ready</div>
</div>

<!-- âœ” Added Clear Button -->
<button id="clearBtn" onclick="clearText()">CLEAR</button>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.4/dist/tesseract.min.js"></script>
<script>
    let video = document.getElementById("video");
    let contentBox = document.getElementById("contentBox");
    let statusDiv = document.getElementById("statusDiv");
    let fileInput = document.getElementById("fileInput");

    let scanning = false, recognizing = false, autoInterval = null; 
    let worker = null;
    let autoRead = true;

    fileInput.addEventListener("change", () => {
        const file = fileInput.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                contentBox.textContent = text; 
                statusDiv.innerText = "Status: File Loaded âœ”";

                if (autoRead) {
                    speechSynthesis.cancel();
                    speechSynthesis.speak(new SpeechSynthesisUtterance(text));
                }
            };
            reader.readAsText(file);
        }
    });

    async function loadWorker() {
        if (worker) return;
        statusDiv.innerText = "Status: Loading AI Core (Tesseract)...";
        worker = Tesseract.createWorker();
        await worker.load();
        await worker.loadLanguage("eng");
        await worker.initialize("eng");
        statusDiv.innerText = "Status: AI Core Ready.";
    }

    async function startScanner() {
        if (scanning) return;
        stopScanner();
        scanning = true;
        try {
            const stream = await navigator.mediaDevices.getUserMedia({video: {width: 1280, height: 720}});
            video.srcObject = stream;
            video.onloadedmetadata = () => {
                statusDiv.innerText = "Status: Camera Live âœ” (Auto Scanning)";
                autoInterval = setInterval(() => {
                    if (!recognizing) runOCR(); 
                }, 2500);
            }
        } catch (error) {
            statusDiv.innerText = "Error: Could not access camera.";
            scanning = false;
        }
    }

    function stopScanner() {
        scanning = false;
        clearInterval(autoInterval);
        let stream = video.srcObject;
        if (stream) stream.getTracks().forEach(t => t.stop());
        video.srcObject = null;
        statusDiv.innerText = "Status: Scanner Stopped";
    }

    async function runOCR() {
        if (!scanning || recognizing) return;
        try {
            recognizing = true;
            await loadWorker();

            let vw = video.videoWidth;
            let vh = video.videoHeight;
            const box = document.getElementById("scannerBox");
            const rect = box.getBoundingClientRect();
            const videoRect = video.getBoundingClientRect();

            const scaleX = vw / videoRect.width;
            const scaleY = vh / videoRect.height;

            const sx = Math.floor((rect.left - videoRect.left) * scaleX);
            const sy = Math.floor((rect.top - videoRect.top) * scaleY);
            const sw = Math.floor(rect.width * scaleX);
            const sh = Math.floor(rect.height * scaleY);

            const canvas = document.createElement("canvas");
            canvas.width = sw;
            canvas.height = sh;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(video, sx, sy, sw, sh, 0, 0, sw, sh);

            const { data: { text } } = await worker.recognize(canvas);
            const cleaned = (text || "").trim();

            if (cleaned && cleaned !== contentBox.textContent.trim()) {
                contentBox.textContent = cleaned; 
                statusDiv.innerText = "Status: Live Text Found âœ”";

                if (autoRead) {
                    speechSynthesis.cancel();
                    speechSynthesis.speak(new SpeechSynthesisUtterance(cleaned));
                }
            } else if (!cleaned) {
                statusDiv.innerText = "Status: Scanning... No text detected yet.";
            }

        } catch (e) {
            statusDiv.innerText = "Status: Error during OCR processing.";
        }
        recognizing = false;
    }

    /* âœ” Clear button function */
    function clearText() {
        contentBox.textContent = "";
        statusDiv.innerText = "Status: Text Cleared âœ”";
        speechSynthesis.cancel();
    }
</script>
</body>
</html>
